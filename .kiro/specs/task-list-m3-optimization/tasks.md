# 任务列表 Material 3 优化实现计划

- [x] 1. 扩展数据模型和ViewModel


  - 在Task数据类中添加isFavorite、sortOrder和tags字段
  - 创建GroupMode和SortMode枚举类
  - 扩展TaskListUiState以支持新的UI状态（分组模式、多选模式、已完成展开状态等）
  - 在TaskViewModel中实现智能排序逻辑（收藏置顶、完成置底）
  - 实现任务分组逻辑（按日期、优先级、标签）
  - _需求: 1.1, 5.1, 5.2, 10.1, 10.2_

- [x] 2. 优化TaskCard组件

  - [x] 2.1 更新TaskCard视觉样式


    - 将卡片圆角从8dp更新为12dp
    - 调整内边距为16dp
    - 实现已完成任务的50%透明度效果
    - 优化逾期任务的errorContainer背景色
    - 添加收藏任务的primaryContainer背景色
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.5, 6.1, 6.2, 6.3_
  
  - [x] 2.2 添加收藏功能UI


    - 在TaskCard右上角添加星标图标按钮
    - 实现星标的填充/未填充状态切换
    - 添加点击星标的涟漪效果
    - _需求: 10.4_
  
  - [x] 2.3 优化任务信息展示

    - 限制标题为单行显示，超出使用省略号
    - 限制描述为最多2行
    - 优化元信息（日期、位置、子任务）的图标和间距
    - 调整优先级指示器为10dp圆形
    - _需求: 6.1, 6.2, 6.3, 6.4_
  
  - [x] 2.4 实现完成状态动画

    - 添加弹性缩放动画（scale 0.95f）
    - 使用Spring动画规范（DampingRatioMediumBouncy）
    - 优化复选框的AnimatedContent过渡
    - _需求: 7.1_

- [x] 3. 实现手势交互系统

  - [x] 3.1 实现向右滑动完成功能


    - 创建SwipeableCard组件包装TaskCard
    - 实现30%滑动阈值触发完成操作
    - 添加绿色背景和勾选图标的背景内容
    - 实现平滑的滑动动画
    - _需求: 2.1, 2.3_
  
  - [x] 3.2 实现向左滑动快捷操作

    - 添加编辑按钮（蓝色背景）//根据系统取色和主题会发生变化
    - 添加删除按钮（红色背景）//强调色不会变
    - 实现滑动显示操作按钮的动画
    - _需求: 2.2, 2.3_
  
  - [x] 3.3 实现长按多选模式


    - 添加长按手势检测
    - 触发震动反馈
    - 在卡片左侧显示复选框
    - 切换顶部栏为批量操作工具栏
    - _需求: 2.4, 2.5_

- [x] 4. 优化TaskStatsCard统计卡片

  - [x] 4.1 重新设计统计卡片布局


    - 使用primaryContainer背景色
    - 调整圆角为16dp
    - 实现三列布局（今日完成、未完成、逾期）
    - _需求: 8.1, 8.4_
  
  - [x] 4.2 添加环形进度指示器

    - 实现CircularProgressIndicator显示完成率
    - 设置尺寸为48dp，strokeWidth为4dp
    - 使用primary色和20%透明度的轨道色
    - _需求: 8.3_
  
  - [x] 4.3 实现数字滚动动画

    - 使用AnimatedContent实现数字变化动画
    - 添加slideInVertically和slideOutVertically过渡
    - 根据数字增减方向调整动画方向
    - _需求: 8.5_

- [x] 5. 实现智能分组和排序

  - [x] 5.1 创建分组标题组件


    - 实现StickyGroupHeader组件
    - 显示分组名称和任务数量徽章
    - 使用tonalElevation实现粘性效果
    - 应用primary色调突出显示
    - _需求: 5.2, 5.3, 5.4_
  
  - [x] 5.2 实现按日期分组

    - 创建DateGroup密封类（逾期、今天、明天、本周等）
    - 实现任务按日期分组的逻辑
    - 使用相对时间标签（"今天"、"明天"）
    - _需求: 5.1, 5.2_
  
  - [x] 5.3 实现分组切换动画


    - 添加分组模式切换时的平滑过渡
    - 使用AnimatedVisibility实现分组展开/折叠
    - _需求: 5.5_

- [x] 6. 实现已完成任务区域

  - [x] 6.1 创建已完成任务分隔线


    - 实现带文字和图标的分隔线组件
    - 显示已完成任务数量
    - 添加展开/折叠图标
    - _需求: 10.5_
  
  - [x] 6.2 实现折叠/展开功能


    - 使用AnimatedVisibility控制已完成任务显示
    - 添加expandVertically和shrinkVertically动画
    - 保存展开状态到ViewModel
    - _需求: 10.5_
  
  - [x] 6.3 实现完成任务自动置底

    - 在任务完成时触发位置动画
    - 使用animateItemPlacement实现平滑移动
    - 更新ViewModel中的任务排序
    - _需求: 10.1, 10.3_

- [x] 7. 实现收藏任务自动置顶

  - 在TaskViewModel中添加toggleFavorite方法
  - 实现收藏状态变化时的任务重排序
  - 添加收藏/取消收藏的位置动画
  - 确保收藏任务始终在列表顶部
  - _需求: 10.2, 10.3_

- [ ] 8. 优化快速添加任务功能
  - [x] 8.1 创建ModalBottomSheet组件


    - 替换AlertDialog为ModalBottomSheet
    - 实现底部表单布局
    - 添加标题、输入框和操作按钮
    - _需求: 4.2_
  
  - [ ] 8.2 添加语音输入功能
    - 在输入框添加麦克风图标按钮
    - 集成语音识别API
    - 将语音转换为文本填充到输入框
    - _需求: 4.3_
  
  - [x] 8.3 优化FAB显示逻辑


    - 实现滚动时自动隐藏/显示FAB
    - 使用AnimatedVisibility控制FAB可见性
    - _需求: 7.5_

- [x] 9. 优化过滤器界面


  - 更新FilterChips组件样式
  - 使用filled样式突出显示选中状态
  - 在过滤器旁显示当前任务数量
  - 优化FilterChip的间距和布局
  - _需求: 9.1, 9.2, 9.3, 9.4, 9.5_

- [x] 10. 优化空状态界面


  - [x] 10.1 重新设计EmptyTaskList组件


    - 使用Material 3图标替代emoji
    - 增大图标尺寸到120dp
    - 调整色彩为primary + 40%透明度
    - _需求: 3.1, 3.2_
  
  - [x] 10.2 添加空状态操作按钮

    - 在空状态下方添加FilledTonalButton
    - 引导用户创建第一个任务
    - _需求: 3.3_
  
  - [x] 10.3 优化搜索无结果状态

    - 使用SearchOff图标
    - 显示搜索关键词
    - 提供清除搜索的建议
    - _需求: 3.4_

- [x] 11. 实现列表动画效果

  - [x] 11.1 添加任务添加动画

    - 使用fadeIn + slideInVertically组合动画
    - 设置300ms的动画时长
    - _需求: 7.2_
  
  - [x] 11.2 添加任务删除动画

    - 使用shrinkVertically + fadeOut组合动画
    - 设置300ms的收缩动画
    - _需求: 7.3_
  
  - [x] 11.3 优化列表项位置动画


    - 在LazyColumn的items中添加animateItemPlacement
    - 确保排序变化时的平滑过渡
    - _需求: 10.3_

- [ ] 12. 实现响应式布局
  - [ ] 12.1 创建WindowSize检测
    - 实现WindowSize枚举（COMPACT、MEDIUM、EXPANDED）
    - 根据屏幕宽度计算当前尺寸
    - _需求: 11.1, 11.2_
  
  - [ ] 12.2 实现双列网格布局
    - 在MEDIUM尺寸下使用LazyVerticalGrid
    - 设置2列固定网格
    - 调整卡片间距
    - _需求: 11.1_
  
  - [ ] 12.3 实现平板布局
    - 在EXPANDED尺寸下使用三列网格或列表+侧边栏
    - 添加任务详情侧边栏
    - _需求: 11.2_
  
  - [ ] 12.4 优化横屏和分屏模式
    - 调整内边距和间距
    - 优化信息展示密度
    - _需求: 11.3, 11.4, 11.5_

- [x] 13. 实现下拉刷新功能


  - 添加PullRefreshIndicator组件
  - 实现下拉手势检测
  - 触发任务数据同步
  - 显示刷新动画
  - _需求: 4.5_

- [ ] 14. 优化性能
  - [x] 14.1 优化LazyColumn性能

    - 为items添加稳定的key
    - 设置contentType提示
    - 使用derivedStateOf避免不必要的重组
    - _需求: 所有需求_
  
  - [ ] 14.2 实现图片懒加载
    - 使用Coil加载附件缩略图
    - 实现图片缓存策略
    - 只加载可见区域的图片
    - _需求: 6.5_

- [x] 15. 添加无障碍支持

  - 为TaskCard添加语义标签
  - 确保触摸目标≥48dp
  - 验证颜色对比度≥4.5:1
  - 添加屏幕阅读器支持
  - _需求: 所有需求_

- [x] 16. 国际化优化

  - 添加日期格式本地化
  - 更新字符串资源
  - 支持RTL布局
  - _需求: 所有需求_
