# 快速修复 - 单双周显示问题

## 最可能的原因

根据您的描述"不管单双周都只显示单周"，最可能的原因是：

**当前周数一直显示为第1周（奇数周）**

这会导致：
- ✅ 单周课程（ODD）显示（因为 1 % 2 == 1 为真）
- ❌ 双周课程（EVEN）不显示（因为 1 % 2 == 0 为假）

## 立即检查

### 1. 查看应用顶部显示的周数

打开课程表页面，查看顶部显示：
```
课程表
第 ? / 18 周
```

**如果显示"第 1 / 18 周"：**
- 这就是问题所在！
- 系统认为现在是第1周（奇数周）
- 所以只显示单周课程

### 2. 检查学期开始日期

**方法A：通过设置查看**
1. 点击右上角的设置图标（齿轮图标）
2. 查看"学期开始日期"

**方法B：通过Logcat查看**
查找日志：
```
D/CourseViewModel: getCurrentWeekNumber: startDate=?, today=?, week=?
```

**常见问题：**
- 学期开始日期 = 今天 → 当前周数 = 1
- 学期开始日期 = 最近几天 → 当前周数 = 1 或 2

## 快速修复方案

### 方案1: 设置正确的学期开始日期（推荐）

1. 打开应用
2. 点击右上角的"日历"图标（学期设置）
3. 找到"学期开始日期"
4. 设置为学期实际开始的日期

**示例：**
- 如果是2025年秋季学期，开始日期应该是 2025-09-01 左右
- 如果是2025年春季学期，开始日期应该是 2025-02-24 左右

**计算当前周数：**
- 今天是 2025-11-04
- 如果学期开始于 2025-09-01
- 那么当前应该是第 10 周（偶数周）

### 方案2: 手动设置当前周数

如果应用有"设置当前周数"功能：

1. 打开课程设置
2. 找到"当前周数"或"设置周数"选项
3. 手动输入当前是第几周

**如何确定当前周数：**
- 查看学校的校历
- 或者根据开学日期计算

### 方案3: 临时测试（验证修复是否有效）

1. 在应用中左右滑动课程表
2. 滑动到"第 2 周"
3. 观察是否显示双周课程

**如果第2周显示了双周课程：**
- ✅ 说明过滤逻辑是正确的
- ✅ 问题确实是当前周数设置错误

**如果第2周仍然只显示单周课程：**
- ❌ 可能是课程的weekPattern设置错误
- 需要检查课程数据

## 验证修复

修复后，验证以下情况：

### 测试1: 奇数周
滑动到任意奇数周（1, 3, 5, 7...）
- ✅ 应该显示：全周课程 + 单周课程
- ❌ 不应该显示：双周课程

### 测试2: 偶数周
滑动到任意偶数周（2, 4, 6, 8...）
- ✅ 应该显示：全周课程 + 双周课程
- ❌ 不应该显示：单周课程

### 测试3: 周模式标识
查看课程卡片右上角：
- 单周课程应该显示"单周"标识
- 双周课程应该显示"双周"标识
- 全周课程不显示标识

## 如果问题仍然存在

### 检查课程数据

1. 点击一个应该在双周显示的课程
2. 查看"周模式"设置
3. 确认是否设置为"双周"

**可能的问题：**
- 所有课程都被设置为"单周"
- 导入的课程周模式设置错误

**解决方法：**
- 手动编辑课程，将周模式改为"双周"
- 或者重新导入课程，确保周模式正确

### 查看Logcat日志

过滤标签：`CourseViewModel`

查找：
```
D/CourseViewModel: isCourseActiveInWeek: [课程名], pattern=[模式], week=[周数], result=[结果]
```

**关键信息：**
1. 双周课程的 `pattern` 是否为 `EVEN`？
2. 当 `week=2` 时，双周课程的 `result` 是否为 `true`？
3. 当 `week=1` 时，双周课程的 `result` 是否为 `false`？

## 总结

**最可能的原因：** 学期开始日期设置错误，导致当前周数一直是第1周

**快速修复：** 设置正确的学期开始日期

**验证方法：** 查看顶部显示的周数，滑动到第2周查看是否显示双周课程
