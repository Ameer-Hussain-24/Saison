# 调试步骤 - 单双周显示问题

## 问题描述
不管单双周都只显示单周的课程。

## 可能的原因

### 1. 当前周数一直是第1周（奇数周）
如果系统计算的当前周数一直是1，那么：
- 单周课程（ODD）会显示（因为 1 % 2 == 1）
- 双周课程（EVEN）不会显示（因为 1 % 2 != 0）

### 2. 学期开始日期设置错误
如果学期开始日期设置得太晚，可能导致当前周数计算错误。

### 3. 课程的weekPattern字段设置错误
所有课程可能都被设置为ODD模式。

## 调试步骤

### 步骤1: 检查Logcat日志

打开Android Studio的Logcat，过滤标签：
- `CourseViewModel`
- `CourseScreen`

查找以下日志：

```
D/CourseViewModel: Week calculation: baseWeek=?, offset=?, result=?
D/CourseViewModel: getCurrentWeekNumber: startDate=?, today=?, week=?
D/CourseScreen: Calculated pageWeek: ?
D/CourseViewModel: isCourseActiveInWeek: [课程名], pattern=[模式], week=[周数], result=[true/false]
```

**关键检查点：**
1. `baseWeek` 的值是多少？
2. `pageWeek` 的值是多少？
3. 每个课程的 `pattern` 是什么？
4. 双周课程的 `result` 是 true 还是 false？

### 步骤2: 检查学期开始日期

1. 打开应用
2. 进入"设置" -> "课程设置" 或 "学期设置"
3. 查看"学期开始日期"是什么时候

**预期：**
- 如果今天是2025年11月4日
- 学期开始日期应该是一个合理的日期（例如2025年9月1日）
- 当前应该是第9周或第10周左右

**如果学期开始日期是今天或最近几天：**
- 那么当前周数会是第1周
- 这就是为什么只显示单周课程

**解决方法：**
- 将学期开始日期设置为学期实际开始的日期
- 或者使用"设置当前周数"功能

### 步骤3: 检查课程的周模式设置

1. 点击一个应该在双周显示的课程
2. 查看"周模式"设置
3. 确认它是否设置为"双周"

**可能的问题：**
- 课程可能被错误地设置为"单周"或"全周"
- 导入的课程可能没有正确设置周模式

### 步骤4: 手动测试

创建两个测试课程：

**课程A - 单周测试**
- 名称：单周测试
- 周模式：单周（ODD）
- 其他设置随意

**课程B - 双周测试**
- 名称：双周测试
- 周模式：双周（EVEN）
- 其他设置随意

然后：
1. 查看当前周的课程表
2. 左右滑动到下一周
3. 观察哪些课程显示

**预期结果：**
- 第1周（奇数周）：应该只显示"单周测试"
- 第2周（偶数周）：应该只显示"双周测试"
- 第3周（奇数周）：应该只显示"单周测试"

**如果实际结果不符合预期：**
- 查看Logcat日志
- 记录 `pageWeek` 的值
- 记录每个课程的过滤结果

## 常见问题和解决方案

### 问题1: 当前周数一直是1

**原因：** 学期开始日期设置为今天或最近

**解决方案：**
```
1. 打开课程设置
2. 找到"学期开始日期"
3. 设置为学期实际开始的日期（例如：2025-09-01）
4. 或者使用"设置当前周数"功能，手动设置为当前是第几周
```

### 问题2: 所有课程都是单周模式

**原因：** 导入或创建课程时，周模式默认设置为单周

**解决方案：**
```
1. 逐个编辑课程
2. 将需要在双周上的课程的周模式改为"双周"
3. 保存
```

### 问题3: 滑动到下一周后，周数没有变化

**原因：** HorizontalPager的页面计算有问题

**解决方案：**
查看Logcat日志中的：
```
D/CourseScreen: === Page ? ===
D/CourseScreen: centerPage: ?, currentWeek: ?
D/CourseScreen: Calculated pageWeek: ?
```

确认 `pageWeek` 是否随着滑动而变化。

## 快速诊断命令

在Logcat中使用以下过滤器：

```
tag:CourseViewModel | tag:CourseScreen
```

然后：
1. 打开课程表页面
2. 记录当前显示的周数
3. 左右滑动
4. 观察日志输出

## 需要提供的信息

如果问题仍然存在，请提供：

1. **Logcat日志输出**（特别是包含以下内容的日志）：
   - Week calculation
   - getCurrentWeekNumber
   - Calculated pageWeek
   - isCourseActiveInWeek

2. **学期设置**：
   - 学期开始日期
   - 当前周数显示

3. **课程设置**：
   - 几个示例课程的周模式设置
   - 是手动创建还是导入的

4. **观察到的行为**：
   - 当前显示哪些课程
   - 滑动到下一周后显示哪些课程
   - 是否所有周都显示相同的课程
