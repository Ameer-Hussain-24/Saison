# 课程表网格化重构需求文档

## 简介

本功能旨在重构课程表的显示方式,从当前的列表式布局改为基于时间网格的布局。新的布局将更直观地展示课程的时间安排,用户可以清晰地看到每节课的时间段,并且课程卡片会根据其跨越的节次自动调整大小。

## 术语表

- **System**: Saison 课程表系统
- **Grid Layout**: 网格布局,以行列形式展示课程时间表
- **Period**: 课程节次,例如第1节、第2节
- **Course Card**: 课程卡片,显示课程信息的UI组件
- **Time Slot**: 时间段,每节课对应的具体时间范围
- **Day Column**: 日期列,表示星期一到星期日的垂直列

## 需求

### 需求 1: 网格布局显示

**用户故事:** 作为学生用户,我希望课程表以网格形式显示,这样我可以更直观地看到每天的课程安排和时间分布。

#### 验收标准

1. WHEN 用户打开课程表页面, THE System SHALL 以网格布局显示课程表
2. THE System SHALL 在网格最左侧显示节次列,包含节次编号(第1节、第2节等)
3. THE System SHALL 在节次编号旁边显示对应的时间范围(例如 08:00-08:45)
4. THE System SHALL 为每个工作日(周一至周日)创建一个垂直列
5. THE System SHALL 在网格顶部显示星期标题(周一、周二等)

### 需求 2: 课程卡片网格定位

**用户故事:** 作为学生用户,我希望课程卡片能够准确地覆盖其对应的时间网格,这样我可以清楚地看到课程的时间跨度。

#### 验收标准

1. WHEN 课程跨越单个节次, THE System SHALL 显示课程卡片覆盖该节次对应的网格单元
2. WHEN 课程跨越多个连续节次, THE System SHALL 显示课程卡片覆盖所有对应的网格单元
3. THE System SHALL 根据课程的 periodStart 和 periodEnd 属性确定卡片位置
4. THE System SHALL 在课程卡片内显示课程名称、地点和时间信息
5. THE System SHALL 为课程卡片应用与课程关联的主题颜色

### 需求 3: 创建课程时选择节次

**用户故事:** 作为学生用户,我希望在创建课程时可以选择开始和结束节次,而不是手动输入时间,这样可以更快速准确地添加课程。

#### 验收标准

1. WHEN 用户打开添加课程面板, THE System SHALL 提供节次选择器用于选择开始节次
2. WHEN 用户打开添加课程面板, THE System SHALL 提供节次选择器用于选择结束节次
3. WHEN 用户选择开始节次, THE System SHALL 限制结束节次选项为开始节次及之后的节次
4. THE System SHALL 根据选择的节次自动计算并填充 startTime 和 endTime
5. THE System SHALL 同时保留自定义时间输入选项,通过切换开关启用

### 需求 4: 编辑课程时节次显示

**用户故事:** 作为学生用户,我希望在编辑课程时能看到当前课程的节次信息,并可以修改节次范围。

#### 验收标准

1. WHEN 用户打开编辑课程面板, THE System SHALL 显示课程当前的开始节次和结束节次
2. WHEN 课程使用自定义时间, THE System SHALL 显示"自定义时间"标识并显示具体时间
3. THE System SHALL 允许用户在节次模式和自定义时间模式之间切换
4. WHEN 用户从自定义时间切换到节次模式, THE System SHALL 自动匹配最接近的节次范围
5. WHEN 用户修改节次范围, THE System SHALL 实时更新时间预览

### 需求 5: 空白网格显示

**用户故事:** 作为学生用户,我希望即使某个时间段没有课程,网格也能显示出来,这样我可以清楚地看到空闲时间。

#### 验收标准

1. THE System SHALL 显示所有配置的节次网格,无论是否有课程
2. WHEN 某个时间段没有课程, THE System SHALL 显示空白网格单元
3. THE System SHALL 为空白网格单元应用浅色背景以区分有课程的单元
4. WHEN 用户点击空白网格单元, THE System SHALL 打开添加课程面板并预填充对应的星期和节次
5. THE System SHALL 在空白网格单元上显示淡化的时间信息

### 需求 6: 网格滚动和导航

**用户故事:** 作为学生用户,我希望可以流畅地滚动查看整周的课程安排,并能快速定位到当前时间。

#### 验收标准

1. THE System SHALL 支持垂直滚动以查看所有节次
2. THE System SHALL 支持水平滚动以查看所有工作日
3. WHEN 用户打开课程表, THE System SHALL 自动滚动到当前时间对应的节次
4. THE System SHALL 高亮显示当前正在进行的课程(如果有)
5. THE System SHALL 提供"回到当前时间"的快速导航按钮

### 需求 7: 响应式网格布局

**用户故事:** 作为学生用户,我希望课程表网格能够适应不同的屏幕尺寸,在手机和平板上都能良好显示。

#### 验收标准

1. THE System SHALL 根据屏幕宽度自动调整网格列宽
2. WHEN 屏幕宽度不足以显示所有工作日, THE System SHALL 启用水平滚动
3. THE System SHALL 保持节次列和时间列固定在左侧,不随水平滚动移动
4. THE System SHALL 根据设备方向(横屏/竖屏)优化网格显示
5. THE System SHALL 确保课程卡片文字在不同屏幕尺寸下都清晰可读

### 需求 8: 课程冲突检测

**用户故事:** 作为学生用户,我希望系统能够检测并提示课程时间冲突,避免我安排重叠的课程。

#### 验收标准

1. WHEN 用户添加或编辑课程, THE System SHALL 检测是否与现有课程时间冲突
2. WHEN 检测到时间冲突, THE System SHALL 显示警告提示,列出冲突的课程
3. THE System SHALL 允许用户选择是否继续保存冲突的课程
4. THE System SHALL 在网格视图中用特殊标识显示有冲突的课程
5. WHEN 多个课程在同一时间段, THE System SHALL 在网格中并排或重叠显示这些课程卡片
